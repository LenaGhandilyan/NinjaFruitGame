<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ninja Fruit Game</title>
  <style>
    /* Basic CSS to style the page */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #111;
      font-family: Arial, sans-serif;
    }

    #canvas {
      border: 2px solid #fff;
      display: block;
    }

    #score {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #fff;
      font-size: 24px;
    }

    #startGame button,
    #returnHome {
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      background-color: #2f89fc;
      color: white;
      border: none;
      border-radius: 5px;
    }

    #startGame, #gameEndDiv {
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Start Game Screen -->
  <div id="startGame">
    <button id="startGameBtn">Start Game</button>
  </div>

  <!-- Game Screen -->
  <div id="insideGameContainer" style="display:none;">
    <canvas id="canvas"></canvas>
    <div id="score">Score: 0</div>
  </div>

  <!-- End Game Screen -->
  <div id="gameEndDiv" style="display:none;">
    <p>Game Over!</p>
    <button id="returnHome">Return Home</button>
  </div>

  <script>
    const playButton = document.getElementById('startGameBtn');
    const startGameContainer = document.getElementById('startGame');
    const inGameContainer = document.getElementById('insideGameContainer');
    const endGameContainer = document.getElementById('gameEndDiv');
    const returnHomeButton = document.getElementById('returnHome');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Adjust canvas size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let fruits = [];
    let missedFruits = 0;
    const maxMissedFruits = 3;
    let score = 0;
    let isMousePressed = false;
    let mouseX = 0;
    let mouseY = 0;

    // Fruit class
    class Fruit {
      constructor(x, y, width, height, image) {
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
        this.image = image;
        this.sliced = false;
        this.vx = Math.random() * 1 - 0.5;
        this.vy = -(Math.random() * 0.5 + 0.5);
      }

      draw() {
        if (!this.sliced) {
          ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
        }
      }

      slice() {
        this.sliced = true;
        score += 10;
        updateScore(score);
      }
    }

    // Update score display
    function updateScore(newScore) {
      document.getElementById('score').textContent = 'Score: ' + newScore;
    }

    // Spawn fruit at random position
    function spawnFruit() {
      const fruitImages = ['banana.png', 'pineapple.png', 'apple.png', 'cherry.png', 'pear.png', 'coconut.png'];
      const randomImage = fruitImages[Math.floor(Math.random() * fruitImages.length)];
      const x = Math.random() * canvas.width;
      const y = canvas.height;
      const width = 50 + Math.random() * 50;
      const height = 50 + Math.random() * 50;

      const fruit = new Fruit(x, y, width, height, new Image());
      fruit.image.src = randomImage;

      fruit.image.onload = () => {
        fruits.push(fruit);
      };
    }

    // Update the game objects (fruits)
    function updateGameObjects() {
      for (let i = fruits.length - 1; i >= 0; i--) {
        let fruit = fruits[i];
        fruit.x -= fruit.vx;
        fruit.y += fruit.vy;

        if (fruit.y > canvas.height) {
          missedFruits++;
          fruits.splice(i, 1);
        }
      }
    }

    // Draw all fruits
    function drawGameObjects() {
      fruits.forEach(fruit => {
        fruit.draw();
      });
    }

    // Check for game over
    function checkGameOver() {
      if (missedFruits >= maxMissedFruits) {
        endGame();
      }
    }

    // End game and show game over screen
    function endGame() {
      alert('Game Over! Too many missed fruits!');
      fruits = [];
      missedFruits = 0;
      inGameContainer.style.display = 'none';
      endGameContainer.style.display = 'block';
    }

    // Game loop
    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      updateGameObjects();
      drawGameObjects();
      checkGameOver();
      requestAnimationFrame(gameLoop);
    }

    // Detect fruit slicing
    canvas.addEventListener('mousedown', (e) => {
      isMousePressed = true;
      mouseX = e.clientX;
      mouseY = e.clientY;

      // Check for fruit slicing
      fruits.forEach(fruit => {
        const distance = Math.hypot(mouseX - fruit.x, mouseY - fruit.y);
        if (distance < fruit.width / 2 && !fruit.sliced) {
          fruit.slice();
        }
      });
    });

    canvas.addEventListener('mousemove', (e) => {
      if (isMousePressed) {
        mouseX = e.clientX;
        mouseY = e.clientY;

        // Check for fruit slicing while moving the mouse
        fruits.forEach(fruit => {
          const distance = Math.hypot(mouseX - fruit.x, mouseY - fruit.y);
          if (distance < fruit.width / 2 && !fruit.sliced) {
            fruit.slice();
          }
        });
      }
    });

    canvas.addEventListener('mouseup', () => {
      isMousePressed = false;
    });

    // Start the game
    playButton.addEventListener('click', () => {
      startGameContainer.style.display = 'none';
      inGameContainer.style.display = 'block';
      score = 0;
      missedFruits = 0;
      updateScore(0);
      fruits = [];
      setInterval(spawnFruit, 3000);  // Generate fruit every 3 seconds
      gameLoop();
    });

    // Return to home screen
    returnHomeButton.addEventListener('click', () => {
      endGameContainer.style.display = 'none';
      startGameContainer.style.display = 'block';
    });
  </script>
</body>
</html>
